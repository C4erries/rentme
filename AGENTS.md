# AGENTS — инструкции для AI‑агентов по проекту Rentme

Этот файл описывает высокоуровневые правила и контекст для AI‑агентов, работающих с репозиторием `rentme`.  
Он дополняет `README.md`, а не заменяет его — всегда начинайте с чтения README.

## Назначение проекта

- Rentme — **маркетплейс аренды жилья** (аналог Airbnb), а не сайт одного отеля или ЖК.
- Поддерживается как **краткосрочная**, так и **долгосрочная** аренда.
- Ключевые будущие компоненты:
  - ML‑сервис ценообразования (отдельный сервис),
  - мессенджер host ↔ guest с хранением истории в ScyllaDB,
  - система оповещений,
  - интеграция с картами (Яндекс),
  - ELK‑стек и микросервисы.

## Архитектурные принципы

- **Модульный монолит с прицелом на микросервисы**
  - Backend (Go) сейчас реализован как модульный монолит.
  - Структура кода должна облегчать дальнейшее разбиение на сервисы (listings, booking, pricing, messaging, notifications и т.д.).

- **DDD‑подход по каталогам**
  - `internal/domain` — чистая доменная логика и модели.
  - `internal/app` — команды/запросы, HTTP‑handlers, middleware, application‑services.
  - `internal/infra` — HTTP‑сервер, логирование, хранилища, конфигурация, адаптеры.

- **Чёткие границы контекстов**
  - Не смешивайте логики разных bounded contexts в одном пакете.
  - State и модели мессенджера, ML‑pricing и уведомлений проектируйте так, чтобы их было легко вынести в отдельные сервисы.

## Правила для изменений

1. **Не превращайте проект в сайт одного объекта**
   - Любая логика должна масштабироваться на множество арендодателей и объявлений.

2. **Минимум новых технологий без запроса**
   - Не добавляйте новые крупные фреймворки или сторонние сервисы, если этого явно не просит пользователь.
   - Используйте уже принятый стек: Go + Gin, MongoDB, Kafka, React + Vite + Tailwind.

3. **Сохранение API‑контрактов**
   - HTTP API версии `/api/v1` не должны ломаться без веской причины.
   - При необходимости breaking changes — предложите схему миграции или новую версию API.

4. **Наблюдаемость и логи**
   - Используйте `obs.NewLogger` и `log/slog` с полями, а не `fmt.Println`.
   - Думайте о том, как эти логи будут анализироваться в ELK.

5. **Чистота домена**
   - В `internal/domain` избегайте зависимостей от инфраструктуры (HTTP, БД, Kafka и т.д.).
   - Вся I/O‑логика должна проходить через адаптеры/интерфейсы и жить в `internal/infra` или `internal/app`.

6. **Frontend**
   - Поддерживайте единый UI‑язык на базе Tailwind.
   - Не привязывайте фронтенд жёстко к конкретным URL backend — используйте `VITE_API_BASE_URL`.

## Приоритеты, если есть сомнения

1. Сохранить архитектурную чистоту и готовность к микросервисам.
2. Не ломать существующий пользовательский сценарий (каталог + просмотр/бронирование).
3. Отдавать предпочтение простым и прозрачным решениям.

При любых нетривиальных решениях опирайтесь на `README.md` и существующую структуру кода. Если возникает неоднозначность — выбирайте вариант, который лучше масштабируется для маркетплейса с множеством арендодателей и арендаторов.

